setwd("C:/Users/dr30094/Coursera - Working Diectory/EDA/Week 1/Peer-Graded Assignment/exdata_data_household_power_consumption")
powerdata <- read.csv("household_power_consumption.txt", header = T, sep = ';', na.strings = "?", nrows = 2075259, check.names = F, stringsAsFactors = F, comment.char = "", quote = '\"')
powerdata_subset <- subset(powerdata, Date %in% c("1/2/2007", "2/2/2007"))
powerdata_subset$Date <- as.Date(powerdata_subset$Date, format = "%d/%m/%y")
date_sub <- paste(as.Date(powerdata_subset$Date), powerdata_subset$Time)
powerdata_subset$date_sub <- as.POSIXct(date_sub)
par(mfrow = c(2, 2), mar = c(4, 4, 2, 1), oma = c(0, 0, 2, 0))
with(powerdata_subset, {
    plot(Global_active_power ~ date_sub, type = "l", col = "black", xlab = "", ylab = "Global Active Power")
    plot(Voltage ~ date_sub, type = "l", col = "black", xlab = "datetime", ylab = "Voltage")
    plot(Sub_metering_1 ~ date_sub, type = "l", col = "black", xlab = "", ylab = "Energy sub metering")
    lines(Sub_metering_2 ~ date_sub, col = "red")
    lines(Sub_metering_3 ~ date_sub, col = "blue")
    legend("topright", lty = 1, lwd = 2, col = c("black", "red", "blue"), legend = c("Sub_metering_1", "Sub_metering_2", "Sub_metering_3"))
    plot(Global_reactive_power ~ date_sub, type = "l", col = "black", xlab = "datetime", ylab = "Global_reactive_power")
})
dev.copy(png, file = "plot4.png")
